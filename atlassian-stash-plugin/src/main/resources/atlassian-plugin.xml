<atlassian-plugin key="${project.groupId}.${project.artifactId}" name="${project.name}" plugins-version="2">
    <plugin-info>
        <description>${project.description}</description>
        <version>${project.version}</version>
        <vendor name="${project.organization.name}" url="${project.organization.url}" />
        <param name="plugin-icon">images/pluginIcon.png</param>
        <param name="plugin-logo">images/pluginLogo.png</param>
    </plugin-info>

    <component-import key="activeObjects" interface="com.atlassian.activeobjects.external.ActiveObjects"/>
    <component-import key="soyTemplateRenderer" interface="com.atlassian.soy.renderer.SoyTemplateRenderer" filter=""/>

    <resource type="i18n" name="i18n" location="stash-git-multimail"/>

    <resource type="download" name="git_multimail.py" location="scripts/git_multimail.py">
        <param name="content-type" value="text/x-python"/>
    </resource>
    <resource type="download" name="send_emails.py" location="scripts/send_emails.py">
        <param name="content-type" value="text/x-python"/>
    </resource>

    <stash-resource key="multimail-soy" name="Multimail Soy Templates">
        <directory location="/templates/"/>
        <dependency>com.atlassian.stash.stash-web-plugin:global</dependency>
    </stash-resource>

    <ao key="ao-module">
        <description>Multimail ActiveObjects entities</description>
        <entity>com.palantir.stash.multimail.admin.ProjectSettings</entity>
    </ao>

    <repository-hook key="git-multimail" name="Send Email Notification of Pushes"
                     class="com.palantir.stash.multimail.StashGitMultimail">
        <description>Sends email notification of pushes to this repository.</description>
        <icon>icons/example.png</icon>
        <config-form name="Email Addresses" key="email-addresses">
            <view>plugin.hook.config.multimail.formContents</view>
            <directory location="/static/"/>
        </config-form>
    </repository-hook>

    <web-item key="projects-settings-link" name="Multimail Project Settings" weight="20" section="stash.project.settings.panel/project-settings-addons-section">
        <label>Multimail Project Settings</label>
        <link linkId="multimail-project-settings-link">/plugins/servlet/multimail/projectsettings/${project.key}</link>
        <tooltip>Project configuration options for Stash Codesearch</tooltip>
    </web-item>

    <servlet key="project-settings-servlet" class="com.palantir.stash.multimail.admin.ProjectSettingsServlet">
        <description key="project-settings-servlet.description">Multimail Project Settings Servlet</description>
        <url-pattern>/multimail/projectsettings/*</url-pattern>
    </servlet>

    <!-- publish our component -->
    <component key="stashGitMultimail" class="com.palantir.stash.multimail.StashGitMultimail"/>
    <component key="pluginLoggerFactory" class="com.palantir.stash.multimail.logger.PluginLoggerFactory"/>
    <component key="settingsManager" class="com.palantir.stash.multimail.admin.SettingsManager"/>

</atlassian-plugin>
